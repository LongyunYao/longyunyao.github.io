<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.2">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.2" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">





  
  
  <link rel="canonical" href="http://yoursite.com/page/3/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Hexo</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/09/OpenGL学习笔记（七）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/09/OpenGL学习笔记（七）/" class="post-title-link" itemprop="url">OpenGL学习笔记（七）</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-09 20:59:47" itemprop="dateCreated datePublished" datetime="2017-05-09T20:59:47+08:00">2017-05-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-06-02 18:07:56" itemprop="dateModified" datetime="2019-06-02T18:07:56+08:00">2019-06-02</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>龙云尧个人博客，转载请注明出处。</p>
<p>CSDN地址：<a href="http://blog.csdn.net/michael753951/article/details/71511785" target="_blank" rel="noopener">http://blog.csdn.net/michael753951/article/details/71511785</a></p>
<p>个人blog地址：<a href="http://yaoyl.cn/nehexue-xi-bi-ji-qi-2017-05-09-20-59/" target="_blank" rel="noopener">http://yaoyl.cn/nehexue-xi-bi-ji-qi-2017-05-09-20-59/</a></p>
<hr>
<p>我们在前六个部分已经尝试了nehe教程中1-8可得所有内容，接下来第七部分将实现一个简单的实验，这个实验将涵盖前面所有的内容，以作为一个前期总结。</p>
<h2 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h2><p>在实验之前，我们需要知道一个OpenGL中的基本概念。OpenGL中glEnable方法的使用。关于这个功能函数的使用以及参数设定，你可以点击<a href="http://blog.csdn.net/liguangzhenghi/article/details/8166350" target="_blank" rel="noopener">【gl.glenable()介绍】</a>以及<a href="http://blog.csdn.net/huutu/article/details/20872525" target="_blank" rel="noopener">【glEnable(GL_DEPTH_TEST) 有什么用？】</a>进行查看。以下关于glenable的内容转载自上述第二篇博客。</p>
<hr>
<p>在InitGL() 或者类似的初始化OpenGL的地方，会有glEnable(GL_DEPTH_TEST);</p>
<p>启用了之后，OpenGL在绘制的时候就会检查，当前像素前面是否有别的像素，如果别的像素挡道了它，那它就不会绘制，也就是说，OpenGL就只绘制最前面的一层。</p>
<p>当我们需要绘制透明图片时，就需要关闭它<br>glDisable(GL_DEPTH_TEST);<br>并且打开混合<br>glEnable(GL_BLEND);</p>
<p>而且还需要设置使用的透明度<br>glColor4f(1.0f,1.0f,1.0f,0.5f);<br>这样就是一半的显示了，设置为1就是不透明</p>
<p>glBlendFunc(GL_SRC_ALPHA,GL_ONE);<br>基于源像素Alpha通道值的半透明混合函数</p>
<hr>
<p>在实验一以及后续的几个实验中，我们Enable的都是传入GL_DEPTH_TEST作为参数启用深度测试。并立刻在glEnable方法后面调用glDepthFunc(GL_LEQUAL);方法进行前景像素的显示设置。</p>
<p>这个概念在之前的实验中有所涉及，但是我们当时没有关注，这里我们将将其单独拿出来进行分析。<strong>本部分以下部分均为转载。</strong>转载来源为<a href="http://blog.csdn.net/u012463389/article/details/50748128" target="_blank" rel="noopener">【glDepthFunc】</a></p>
<p>函数原型：</p>
<pre><code>void glDepthFunc(GLenum func);</code></pre><p>函数功能：</p>
<pre><code>指定“目标像素与当前像素在z方向上值大小比较”的函数，符合该函数关系的目标像素才进行绘制，否则对目标像素不予绘制。</code></pre><p>参数说明：</p>
<pre><code>func指定深度比较函数，GL_NEVER,GL_LESS,GL_EQUAL,GL_LEQUAL,GL_GREATER,GL_NOTE_QUAL,GL_GEQUAL,GL_ALWAYS,缺省值GL_LESS，</code></pre><p>GL_NEVER,不通过（输入的深度值不取代参考值）</p>
<p>GL_LESS,如果输入的深度值小于参考值，则通过</p>
<p>GL_EQUAL,如果输入的深度值等于参考值，则通过</p>
<p>GL_LEQUAL,如果输入的深度值小于或等于参考值，则通过</p>
<p>GL_GREATER,如果输入的深度值大于参考值，则通过</p>
<p>GL_NOTE_QUAL,如果输入的深度值不等于参考值，则通过</p>
<p>GL_GEQUAL,如果输入的深度值大于或等于参考值，则通过</p>
<p>GL_ALWAYS,总是通过（输入的深度值取代参考值）</p>
<p>描述：</p>
<pre><code>通过目标像素与当前像素在z方向上值大小的比较是否满足参数指定的条件，来决定在深度（z方向）上是否绘制该目标像素。该函数只有启用“深度测试”时才有效，参考glEnable(GL_DEPTH_TEST)和glDisable(GL_DEPTH_TEST)</code></pre><h2 id="代码分析"><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h2><p>前期准备能够帮助我们更好的理解作者在代码中的方法调用，，也能帮助我们更加深入的了解OpenGL的运行机制。我们接下来探讨本次实验中的实现方式。</p>
<p>根据Lesson1课程给我们大基建好的框架结构以及我们整理出来的那张结构图，我们可以快速理解本次实验代码。</p>
<p>首先定义了一个stars结构体，用来存放每一个星星的RGB值，与中心点的距离以及选装角度。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>              // <span class="title">Create</span> <span class="title">A</span> <span class="title">Structure</span> <span class="title">For</span> <span class="title">Star</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> r, g, b;            <span class="comment">// Stars Color</span></span><br><span class="line">    GLfloat dist,           <span class="comment">// Stars Distance From Center</span></span><br><span class="line">        angle;          <span class="comment">// Stars Current Angle</span></span><br><span class="line">&#125;</span><br><span class="line">stars;</span><br><span class="line">stars star[num];            <span class="comment">// Need To Keep Track Of 'num' Stars</span></span><br></pre></td></tr></table></figure>

<p>接着是LoadBMP和LoadGLTextures，这个和以前的实验代码无异，只需要改一下读入的文件名即可。ReSizeGLScene函数同样不需要修改。</p>
<p>接下来的InitGL开始，将会和第一节课开始出现不一样。</p>
<p>首先我们在前期准备中已经知道了glEnable的意义，并且我们也已经知道，深度测试和透明两种功能不能同时开启。而我们在上一次实验中在设置透明的时候，也曾经写过如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">glEnable(GL_BLEND);         // Turn Blending On</span><br><span class="line">glDisable(GL_DEPTH_TEST);   // Turn Depth Testing Off</span><br></pre></td></tr></table></figure>

<p>又因为本次实验需要直接使用透明，所以我们在InitGL中将不再glDisable(GL_BLEND)，而是直接glEnable(GL_BLEND)。</p>
<p>接着就是很重要的一个方法了——DrawGLScene，这个地方，作者将星星的旋转以及着色代码在这里进行实现。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">DrawGLScene</span><span class="params">(GLvoid)</span>                                 <span class="comment">// Here's Where We Do All The Drawing</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); <span class="comment">// Clear The Screen And The Depth Buffer</span></span><br><span class="line">    glBindTexture(GL_TEXTURE_2D, texture[<span class="number">0</span>]);           <span class="comment">// Select Our Texture</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (loop=<span class="number">0</span>; loop&lt;num; loop++)                      <span class="comment">// Loop Through All The Stars</span></span><br><span class="line">    &#123;</span><br><span class="line">        glLoadIdentity();                               <span class="comment">// Reset The View Before We Draw Each Star</span></span><br><span class="line">        glTranslatef(<span class="number">0.0f</span>,<span class="number">0.0f</span>,zoom);                   <span class="comment">// Zoom Into The Screen (Using The Value In 'zoom')</span></span><br><span class="line">        glRotatef(tilt,<span class="number">1.0f</span>,<span class="number">0.0f</span>,<span class="number">0.0f</span>);                 <span class="comment">// Tilt The View (Using The Value In 'tilt')</span></span><br><span class="line">        glRotatef(star[loop].angle,<span class="number">0.0f</span>,<span class="number">1.0f</span>,<span class="number">0.0f</span>);     <span class="comment">// Rotate To The Current Stars Angle</span></span><br><span class="line">        glTranslatef(star[loop].dist,<span class="number">0.0f</span>,<span class="number">0.0f</span>);        <span class="comment">// Move Forward On The X Plane</span></span><br><span class="line">        glRotatef(-star[loop].angle,<span class="number">0.0f</span>,<span class="number">1.0f</span>,<span class="number">0.0f</span>);    <span class="comment">// Cancel The Current Stars Angle</span></span><br><span class="line">        glRotatef(-tilt,<span class="number">1.0f</span>,<span class="number">0.0f</span>,<span class="number">0.0f</span>);                <span class="comment">// Cancel The Screen Tilt</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (twinkle)</span><br><span class="line">        &#123;</span><br><span class="line">            glColor4ub(star[(num-loop)<span class="number">-1</span>].r,star[(num-loop)<span class="number">-1</span>].g,star[(num-loop)<span class="number">-1</span>].b,<span class="number">255</span>);</span><br><span class="line">            glBegin(GL_QUADS);</span><br><span class="line">                glTexCoord2f(<span class="number">0.0f</span>, <span class="number">0.0f</span>); glVertex3f(<span class="number">-1.0f</span>,<span class="number">-1.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">                glTexCoord2f(<span class="number">1.0f</span>, <span class="number">0.0f</span>); glVertex3f( <span class="number">1.0f</span>,<span class="number">-1.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">                glTexCoord2f(<span class="number">1.0f</span>, <span class="number">1.0f</span>); glVertex3f( <span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">                glTexCoord2f(<span class="number">0.0f</span>, <span class="number">1.0f</span>); glVertex3f(<span class="number">-1.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">            glEnd();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        glRotatef(spin,<span class="number">0.0f</span>,<span class="number">0.0f</span>,<span class="number">1.0f</span>);</span><br><span class="line">        glColor4ub(star[loop].r,star[loop].g,star[loop].b,<span class="number">255</span>);</span><br><span class="line">        glBegin(GL_QUADS);</span><br><span class="line">            glTexCoord2f(<span class="number">0.0f</span>, <span class="number">0.0f</span>); glVertex3f(<span class="number">-1.0f</span>,<span class="number">-1.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">            glTexCoord2f(<span class="number">1.0f</span>, <span class="number">0.0f</span>); glVertex3f( <span class="number">1.0f</span>,<span class="number">-1.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">            glTexCoord2f(<span class="number">1.0f</span>, <span class="number">1.0f</span>); glVertex3f( <span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">            glTexCoord2f(<span class="number">0.0f</span>, <span class="number">1.0f</span>); glVertex3f(<span class="number">-1.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">        glEnd();</span><br><span class="line"></span><br><span class="line">        spin+=<span class="number">0.01f</span>;</span><br><span class="line">        star[loop].angle+=<span class="keyword">float</span>(loop)/num;</span><br><span class="line">        star[loop].dist-=<span class="number">0.01f</span>;</span><br><span class="line">        <span class="keyword">if</span> (star[loop].dist&lt;<span class="number">0.0f</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            star[loop].dist+=<span class="number">5.0f</span>;</span><br><span class="line">            star[loop].r=rand()%<span class="number">256</span>;</span><br><span class="line">            star[loop].g=rand()%<span class="number">256</span>;</span><br><span class="line">            star[loop].b=rand()%<span class="number">256</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> TRUE;                                        <span class="comment">// Everything Went OK</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果我们在之前的课程中已经很深入的了解了的话，这一次的DrawScene就比较容易理解啦，我也就不在这里重复赘述了。</p>
<p>对winMain稍作修改。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> WINAPI <span class="title">WinMain</span><span class="params">( HINSTANCE   hInstance,          <span class="comment">// Instance</span></span></span></span><br><span class="line"><span class="function"><span class="params">                    HINSTANCE   hPrevInstance,      <span class="comment">// Previous Instance</span></span></span></span><br><span class="line"><span class="function"><span class="params">                    LPSTR       lpCmdLine,          <span class="comment">// Command Line Parameters</span></span></span></span><br><span class="line"><span class="function"><span class="params">                    <span class="keyword">int</span>         nCmdShow)</span>           <span class="comment">// Window Show State</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MSG     msg;                                    <span class="comment">// Windows Message Structure</span></span><br><span class="line">    BOOL    done=FALSE;                             <span class="comment">// Bool Variable To Exit Loop</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Ask The User Which Screen Mode They Prefer</span></span><br><span class="line">    <span class="keyword">if</span> (MessageBox(<span class="literal">NULL</span>,<span class="string">"Would You Like To Run In Fullscreen Mode?"</span>, <span class="string">"Start FullScreen?"</span>,MB_YESNO|MB_ICONQUESTION)==IDNO)</span><br><span class="line">    &#123;</span><br><span class="line">        fullscreen=FALSE;                           <span class="comment">// Windowed Mode</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Create Our OpenGL Window</span></span><br><span class="line">    <span class="keyword">if</span> (!CreateGLWindow(<span class="string">"NeHe's Animated Blended Textures Tutorial"</span>,<span class="number">640</span>,<span class="number">480</span>,<span class="number">16</span>,fullscreen))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;                                   <span class="comment">// Quit If Window Was Not Created</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!done)                                    <span class="comment">// Loop That Runs While done=FALSE</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (PeekMessage(&amp;msg,<span class="literal">NULL</span>,<span class="number">0</span>,<span class="number">0</span>,PM_REMOVE))   <span class="comment">// Is There A Message Waiting?</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (msg.message==WM_QUIT)               <span class="comment">// Have We Received A Quit Message?</span></span><br><span class="line">            &#123;</span><br><span class="line">                done=TRUE;                          <span class="comment">// If So done=TRUE</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>                                    <span class="comment">// If Not, Deal With Window Messages</span></span><br><span class="line">            &#123;</span><br><span class="line">                TranslateMessage(&amp;msg);             <span class="comment">// Translate The Message</span></span><br><span class="line">                DispatchMessage(&amp;msg);              <span class="comment">// Dispatch The Message</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>                                        <span class="comment">// If There Are No Messages</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// Draw The Scene.  Watch For ESC Key And Quit Messages From DrawGLScene()</span></span><br><span class="line">            <span class="keyword">if</span> ((active &amp;&amp; !DrawGLScene()) || keys[VK_ESCAPE])  <span class="comment">// Active?  Was There A Quit Received?</span></span><br><span class="line">            &#123;</span><br><span class="line">                done=TRUE;                          <span class="comment">// ESC or DrawGLScene Signalled A Quit</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>                                    <span class="comment">// Not Time To Quit, Update Screen</span></span><br><span class="line">            &#123;</span><br><span class="line">                SwapBuffers(hDC);                   <span class="comment">// Swap Buffers (Double Buffering)</span></span><br><span class="line">                <span class="keyword">if</span> (keys[<span class="string">'T'</span>] &amp;&amp; !tp)</span><br><span class="line">                &#123;</span><br><span class="line">                    tp=TRUE;</span><br><span class="line">                    twinkle=!twinkle;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (!keys[<span class="string">'T'</span>])</span><br><span class="line">                &#123;</span><br><span class="line">                    tp=FALSE;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (keys[VK_UP])</span><br><span class="line">                &#123;</span><br><span class="line">                    tilt-=<span class="number">0.5f</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (keys[VK_DOWN])</span><br><span class="line">                &#123;</span><br><span class="line">                    tilt+=<span class="number">0.5f</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (keys[VK_PRIOR])</span><br><span class="line">                &#123;</span><br><span class="line">                    zoom-=<span class="number">0.2f</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (keys[VK_NEXT])</span><br><span class="line">                &#123;</span><br><span class="line">                    zoom+=<span class="number">0.2f</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (keys[VK_F1])                        <span class="comment">// Is F1 Being Pressed?</span></span><br><span class="line">                &#123;</span><br><span class="line">                    keys[VK_F1]=FALSE;                  <span class="comment">// If So Make Key FALSE</span></span><br><span class="line">                    KillGLWindow();                     <span class="comment">// Kill Our Current Window</span></span><br><span class="line">                    fullscreen=!fullscreen;             <span class="comment">// Toggle Fullscreen / Windowed Mode</span></span><br><span class="line">                    <span class="comment">// Recreate Our OpenGL Window</span></span><br><span class="line">                    <span class="keyword">if</span> (!CreateGLWindow(<span class="string">"NeHe's Animated Blended Textures Tutorial"</span>,<span class="number">640</span>,<span class="number">480</span>,<span class="number">16</span>,fullscreen))</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>;                       <span class="comment">// Quit If Window Was Not Created</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Shutdown</span></span><br><span class="line">    KillGLWindow();                                 <span class="comment">// Kill The Window</span></span><br><span class="line">    <span class="keyword">return</span> (msg.wParam);                            <span class="comment">// Exit The Program</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同样，很好理解的代码我就不重复解释了。最终运行的结果如图所示。</p>
<p><img src="http://img.blog.csdn.net/20170516074904158?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/07/OpenGL学习笔记（五）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/07/OpenGL学习笔记（五）/" class="post-title-link" itemprop="url">OpenGL学习笔记（五）</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-07 12:21:42" itemprop="dateCreated datePublished" datetime="2017-05-07T12:21:42+08:00">2017-05-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-06-02 18:04:42" itemprop="dateModified" datetime="2019-06-02T18:04:42+08:00">2019-06-02</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>龙云尧个人博客，转载请注明出处。</strong></p>
<p>CSDN地址：<a href="http://blog.csdn.net/michael753951/article/details/71316132" target="_blank" rel="noopener">http://blog.csdn.net/michael753951/article/details/71316132</a></p>
<p>个人blog地址：<a href="http://yaoyl.cn/nehexue-xi-bi-ji-wu/" target="_blank" rel="noopener">http://yaoyl.cn/nehexue-xi-bi-ji-wu/</a></p>
<hr>
<p>这次我们将尝试Lesson6和Lesson7的内容。这个部分我们将学习怎么给一个模型进行纹理映射（其实就是贴图）。</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>这次实验因为需要使用OpenGL的glaux.h库头使用位图对构建的图形进行纹理映射。所以我们需要进一步进行环境搭建。（注：环境搭建很麻烦，因为微软的VS环境很乱）</p>
<p>如何布置这个库头可以参考<a href="http://blog.csdn.net/delphiwcdj/article/details/6326586/" target="_blank" rel="noopener">【 VS2008无法打开gl/glaux.h头文件的解决方法】</a>我使用的是方法4，测试能够正确include库头。</p>
<p>在高版本的VS中，因为VS使用的是自己重新修改过的C++，所以在进行编译的过程中，可能会出现ERROR LNK2019报错，无法解析“_sscanf,_sscanf_s”，这个时候我们可以参考<a href="http://blog.csdn.net/u010317005/article/details/51155363" target="_blank" rel="noopener">【 VS2015 无法解析的外部符号 __vsnwprintf_s】</a></p>
<p>如果我们在使用AUX_RGBImageRec定义变量的时候，系统没有报错的话，就说明我们本次基本的环境已经搭建好了。</p>
<p>另外，因为我们在实验中需要使用fopen，而微软的VS2015中会强行报错，为了避免不必要的麻烦，我们需要关掉fopen的报错。这个部分我们可以参考<a href="http://jingyan.baidu.com/article/ce436649fd61543773afd32e.html" target="_blank" rel="noopener">【百度经验：VS2013中如何解决error C4996: ‘fopen’问题】</a></p>
<h2 id="开始实现"><a href="#开始实现" class="headerlink" title="开始实现"></a>开始实现</h2><p>如果没出什么问题的话，到这里我们应该能够正常的编写这一刻的代码了。（如果还有什么报错请尝试自行解决或者戳我）。</p>
<p>本次需要在3维图像上添加纹理映射，首先需要的是读取位图像文件。读取的代码如下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">AUX_RGBImageRec *<span class="title">LoadBMP</span><span class="params">(<span class="keyword">char</span> *Filename)</span>                <span class="comment">// Loads A Bitmap Image</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *File=<span class="literal">NULL</span>;                                    <span class="comment">// File Handle</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!Filename)                                      <span class="comment">// Make Sure A Filename Was Given</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;                                    <span class="comment">// If Not Return NULL</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    File=fopen(Filename,<span class="string">"r"</span>);                           <span class="comment">// Check To See If The File Exists</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (File)                                           <span class="comment">// Does The File Exist?</span></span><br><span class="line">    &#123;</span><br><span class="line">        fclose(File);                                   <span class="comment">// Close The Handle</span></span><br><span class="line">        <span class="keyword">return</span> auxDIBImageLoad(Filename);               <span class="comment">// Load The Bitmap And Return A Pointer</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;                                        <span class="comment">// If Load Failed Return NULL</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LoadGLTextures</span><span class="params">()</span>                                    <span class="comment">// Load Bitmaps And Convert To Textures</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> Status=FALSE;                                   <span class="comment">// Status Indicator</span></span><br><span class="line"></span><br><span class="line">    AUX_RGBImageRec *TextureImage[<span class="number">1</span>];                   <span class="comment">// Create Storage Space For The Texture</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(TextureImage,<span class="number">0</span>,<span class="keyword">sizeof</span>(<span class="keyword">void</span> *)*<span class="number">1</span>);            <span class="comment">// Set The Pointer To NULL</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Load The Bitmap, Check For Errors, If Bitmap's Not Found Quit</span></span><br><span class="line">    <span class="keyword">if</span> (TextureImage[<span class="number">0</span>]=LoadBMP(<span class="string">"Data/NeHe.bmp"</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        Status=TRUE;                                    <span class="comment">// Set The Status To TRUE</span></span><br><span class="line"></span><br><span class="line">        glGenTextures(<span class="number">1</span>, &amp;texture[<span class="number">0</span>]);                  <span class="comment">// Create The Texture</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Typical Texture Generation Using Data From The Bitmap</span></span><br><span class="line">        glBindTexture(GL_TEXTURE_2D, texture[<span class="number">0</span>]);</span><br><span class="line">        glTexImage2D(GL_TEXTURE_2D, <span class="number">0</span>, <span class="number">3</span>, TextureImage[<span class="number">0</span>]-&gt;sizeX, TextureImage[<span class="number">0</span>]-&gt;sizeY, <span class="number">0</span>, GL_RGB, GL_UNSIGNED_BYTE, TextureImage[<span class="number">0</span>]-&gt;data);</span><br><span class="line">        glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR);</span><br><span class="line">        glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_LINEAR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (TextureImage[<span class="number">0</span>])                                    <span class="comment">// If Texture Exists</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (TextureImage[<span class="number">0</span>]-&gt;data)                          <span class="comment">// If Texture Image Exists</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">free</span>(TextureImage[<span class="number">0</span>]-&gt;data);                    <span class="comment">// Free The Texture Image Memory</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">free</span>(TextureImage[<span class="number">0</span>]);                              <span class="comment">// Free The Image Structure</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Status;                                      <span class="comment">// Return The Status</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第一个函数LoadBMP不需要解释，主要功能就是探寻目的位置中是否存在该图像文件。如果存在就调用auxDIBImageLoad将位图加载成渲染文件返回出来。</p>
<p>第二个函数LoadGLTextures要稍微注意一下，在本次实验中是很重要的一个功能函数。</p>
<p>函数中定义了一个LoadGLTextures数组用来存放位图的句柄，这里因为我们只读取了一张位图，所以只开了一个大小的数组。</p>
<p>接着调用LoadBMP将位图转换成为纹理渲染文件存进TextureImage， glGenTextures(1, &amp;texture[0]) 告诉OpenGL我们想生成一个纹理名字，glBindTexture将纹理名字 texture[0] 绑定到纹理目标上。</p>
<p>然后我们调用glTexImage2D进行纹理的创建。然后使用glTexParameteri对图像进行放大和缩小的滤波器进行设置。</p>
<p>最后再纹理穿件完成之后，我们需要释放掉纹理渲染数组中的内容。</p>
<p>整个纹理渲染工作到这里也就结束了。我们对InitGL稍作修改，使用LoadGLTextures检验位图是否存在，然后调用glEnable启用映射</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">InitGL</span><span class="params">(GLvoid)</span>        <span class="comment">// 此处开始对OpenGL进行所有设置</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> <span class="keyword">if</span> (!LoadGLTextures())       <span class="comment">// 调用纹理载入子例程</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">return</span> FALSE;       <span class="comment">// 如果未能载入，返回FALSE</span></span><br><span class="line"> &#125;</span><br><span class="line"> glEnable(GL_TEXTURE_2D);      <span class="comment">// 启用纹理映射</span></span><br><span class="line"> glShadeModel(GL_SMOOTH);      <span class="comment">// 启用阴影平滑</span></span><br><span class="line"> glClearColor(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">0.5f</span>);     <span class="comment">// 黑色背景</span></span><br><span class="line"> glClearDepth(<span class="number">1.0f</span>);       <span class="comment">// 设置深度缓存</span></span><br><span class="line"> glEnable(GL_DEPTH_TEST);      <span class="comment">// 启用深度测试</span></span><br><span class="line"> glDepthFunc(GL_LEQUAL);       <span class="comment">// 所作深度测试的类型</span></span><br><span class="line"> glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);   <span class="comment">// 真正精细的透视修正</span></span><br><span class="line"> <span class="keyword">return</span> TRUE;        <span class="comment">// 初始化 OK</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后我们按照惯例，修改DrawGLScene方法，需要注意的是，在将纹理贴上模型的时候，需要调用glTexCoord2f方法，第一个参数是X坐标，0.0是纹理的左侧，0.5是纹理的中点，1.0是纹理的右侧。第二个参数是Y坐标，0.0是纹理的底部，0.5是纹理的中点，1.0是纹理的顶部。将4个点全部绑定在张芳行上面之后，便能够正常的显示了。需要注意的是，在glTexCoord2f方法中，参考系是以图像的右下角作为原点，左边为X轴正方向，上方为Y轴正方向（和绘图中的直角坐标系的设定相似）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">int DrawGLScene(GLvoid)                                 // Here&apos;s Where We Do All The Drawing</span><br><span class="line">&#123;</span><br><span class="line">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); // Clear The Screen And The Depth Buffer</span><br><span class="line">    glLoadIdentity();                                   // Reset The View</span><br><span class="line">    glTranslatef(0.0f,0.0f,-5.0f);</span><br><span class="line"></span><br><span class="line">    glRotatef(xrot,1.0f,0.0f,0.0f);</span><br><span class="line">    glRotatef(yrot,0.0f,1.0f,0.0f);</span><br><span class="line">    glRotatef(zrot,0.0f,0.0f,1.0f);</span><br><span class="line"></span><br><span class="line">    glBindTexture(GL_TEXTURE_2D, texture[0]);</span><br><span class="line"></span><br><span class="line">    glBegin(GL_QUADS);</span><br><span class="line">        // Front Face</span><br><span class="line">        glTexCoord2f(0.0f, 0.0f); glVertex3f(-1.0f, -1.0f,  1.0f);</span><br><span class="line">        glTexCoord2f(1.0f, 0.0f); glVertex3f( 1.0f, -1.0f,  1.0f);</span><br><span class="line">        glTexCoord2f(1.0f, 1.0f); glVertex3f( 1.0f,  1.0f,  1.0f);</span><br><span class="line">        glTexCoord2f(0.0f, 1.0f); glVertex3f(-1.0f,  1.0f,  1.0f);</span><br><span class="line">        // Back Face</span><br><span class="line">        glTexCoord2f(1.0f, 0.0f); glVertex3f(-1.0f, -1.0f, -1.0f);</span><br><span class="line">        glTexCoord2f(1.0f, 1.0f); glVertex3f(-1.0f,  1.0f, -1.0f);</span><br><span class="line">        glTexCoord2f(0.0f, 1.0f); glVertex3f( 1.0f,  1.0f, -1.0f);</span><br><span class="line">        glTexCoord2f(0.0f, 0.0f); glVertex3f( 1.0f, -1.0f, -1.0f);</span><br><span class="line">        // Top Face</span><br><span class="line">        glTexCoord2f(0.0f, 1.0f); glVertex3f(-1.0f,  1.0f, -1.0f);</span><br><span class="line">        glTexCoord2f(0.0f, 0.0f); glVertex3f(-1.0f,  1.0f,  1.0f);</span><br><span class="line">        glTexCoord2f(1.0f, 0.0f); glVertex3f( 1.0f,  1.0f,  1.0f);</span><br><span class="line">        glTexCoord2f(1.0f, 1.0f); glVertex3f( 1.0f,  1.0f, -1.0f);</span><br><span class="line">        // Bottom Face</span><br><span class="line">        glTexCoord2f(1.0f, 1.0f); glVertex3f(-1.0f, -1.0f, -1.0f);</span><br><span class="line">        glTexCoord2f(0.0f, 1.0f); glVertex3f( 1.0f, -1.0f, -1.0f);</span><br><span class="line">        glTexCoord2f(0.0f, 0.0f); glVertex3f( 1.0f, -1.0f,  1.0f);</span><br><span class="line">        glTexCoord2f(1.0f, 0.0f); glVertex3f(-1.0f, -1.0f,  1.0f);</span><br><span class="line">        // Right face</span><br><span class="line">        glTexCoord2f(1.0f, 0.0f); glVertex3f( 1.0f, -1.0f, -1.0f);</span><br><span class="line">        glTexCoord2f(1.0f, 1.0f); glVertex3f( 1.0f,  1.0f, -1.0f);</span><br><span class="line">        glTexCoord2f(0.0f, 1.0f); glVertex3f( 1.0f,  1.0f,  1.0f);</span><br><span class="line">        glTexCoord2f(0.0f, 0.0f); glVertex3f( 1.0f, -1.0f,  1.0f);</span><br><span class="line">        // Left Face</span><br><span class="line">        glTexCoord2f(0.0f, 0.0f); glVertex3f(-1.0f, -1.0f, -1.0f);</span><br><span class="line">        glTexCoord2f(1.0f, 0.0f); glVertex3f(-1.0f, -1.0f,  1.0f);</span><br><span class="line">        glTexCoord2f(1.0f, 1.0f); glVertex3f(-1.0f,  1.0f,  1.0f);</span><br><span class="line">        glTexCoord2f(0.0f, 1.0f); glVertex3f(-1.0f,  1.0f, -1.0f);</span><br><span class="line">    glEnd();</span><br><span class="line"></span><br><span class="line">    xrot+=0.3f;</span><br><span class="line">    yrot+=0.2f;</span><br><span class="line">    zrot+=0.4f;</span><br><span class="line">    return TRUE;                                        // Keep Going</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>方法中，在begin之前，我们先预先定义好图像的旋转方式（不一定非要放在begin之前）。</p>
<p>接着调用glBindTexture进行绑定。我们就能够开始进行纹理渲染的绑定操作了。</p>
<p>操作中我们在每次定义点的同时，将纹理的四个角也固定在对应的点上，便能够完成绑定工作。</p>
<p>注意，用原引博客的话说，<strong>当您想改变纹理时，应该绑定新的纹理。有一点值得指出的是，您不能在 glBegin() 和 glEnd() 之间绑定纹理，必须在 glBegin() 之前或 glEnd() 之后绑定。</strong></p>
<p>到这一步，这一课内容也就结束了。</p>
<p><img src="http://img.blog.csdn.net/20170516074420532?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="section5.1"></p>
<h2 id="课程7的实现"><a href="#课程7的实现" class="headerlink" title="课程7的实现"></a>课程7的实现</h2><p>我们接下来尝试课程7的内容。</p>
<p>课程7将带领我们建立一个光照系统，我们也将在这个课程中尝试添加按键控制。通过这个课程，我们会对OpenGL中的光照系统的实现、控制以及如何实现按键控制有一个入门的了解。本次实验基于课程6的内容进行进一步扩展。</p>
<p>实验中，因为我们需要首先添加一些群居变量用来对按键状态进行识别，同时也还要添加一些全局变量用来记录图像的旋转角度。</p>
<p>因此我们在全局变量中添加如下变量。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">GLfloat xrot;               <span class="comment">// X 旋转角度</span></span><br><span class="line">GLfloat yrot;               <span class="comment">// Y 旋转角度</span></span><br><span class="line">GLfloat xspeed;             <span class="comment">// X 旋转速度</span></span><br><span class="line">GLfloat yspeed;             <span class="comment">// Y 旋转速度</span></span><br><span class="line">GLfloat z=<span class="number">-5.0f</span>;            <span class="comment">// Depth Into The Screen</span></span><br><span class="line"></span><br><span class="line">GLfloat LightAmbient[]=     &#123; <span class="number">0.5f</span>, <span class="number">0.5f</span>, <span class="number">0.5f</span>, <span class="number">1.0f</span> &#125;;</span><br><span class="line">GLfloat LightDiffuse[]=     &#123; <span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">1.0f</span> &#125;;</span><br><span class="line">GLfloat LightPosition[]=    &#123; <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">2.0f</span>, <span class="number">1.0f</span> &#125;;</span><br><span class="line"></span><br><span class="line">GLuint  filter;             <span class="comment">// 滤波器类型</span></span><br><span class="line">GLuint  texture[<span class="number">3</span>];         <span class="comment">// 3中纹理文件指针</span></span><br></pre></td></tr></table></figure>

<p>上面代码中，中间3行数组分别表示环境光变量数组，漫射光变量数组，以及光源位置数组。</p>
<p>其中，我们需要了解一下环境光和漫射光的意义是什么。<strong>环境光来自于四面八方。所有场景中的对象都处于环境光的照射中；漫射光由特定的光源产生，并在您的场景中的对象表面上产生反射。处于漫射光直接照射下的任何对象表面都变得很亮，而几乎未被照射到的区域就显得要暗一些。</strong></p>
<p>LightAmbient和LightDiffuse创建光源的过程和颜色的创建完全一致。前三个参数分别是RGB三色分量，最后一个是alpha通道参数。</p>
<p>而LightPosition中，前三个参数表示光源的XYZ左坐标，最后一个参数将告诉OpenGL这里指定的坐标就是光源的位置。</p>
<p>然后我们在上一次实验的基础上稍稍稍修改LoadGLTextures函数。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LoadGLTextures</span><span class="params">()</span>                                    <span class="comment">// Load Bitmaps And Convert To Textures</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> Status=FALSE;                                   <span class="comment">// Status Indicator</span></span><br><span class="line"></span><br><span class="line">    AUX_RGBImageRec *TextureImage[<span class="number">1</span>];                   <span class="comment">// Create Storage Space For The Texture</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(TextureImage,<span class="number">0</span>,<span class="keyword">sizeof</span>(<span class="keyword">void</span> *)*<span class="number">1</span>);            <span class="comment">// Set The Pointer To NULL</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Load The Bitmap, Check For Errors, If Bitmap's Not Found Quit</span></span><br><span class="line">    <span class="keyword">if</span> (TextureImage[<span class="number">0</span>]=LoadBMP(<span class="string">"Data/Crate.bmp"</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        Status=TRUE;                                    <span class="comment">// Set The Status To TRUE</span></span><br><span class="line"></span><br><span class="line">        glGenTextures(<span class="number">3</span>, &amp;texture[<span class="number">0</span>]);                  <span class="comment">// Create Three Textures</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create Nearest Filtered Texture</span></span><br><span class="line">        glBindTexture(GL_TEXTURE_2D, texture[<span class="number">0</span>]);</span><br><span class="line">        glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_NEAREST);</span><br><span class="line">        glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_NEAREST);</span><br><span class="line">        glTexImage2D(GL_TEXTURE_2D, <span class="number">0</span>, <span class="number">3</span>, TextureImage[<span class="number">0</span>]-&gt;sizeX, TextureImage[<span class="number">0</span>]-&gt;sizeY, <span class="number">0</span>, GL_RGB, GL_UNSIGNED_BYTE, TextureImage[<span class="number">0</span>]-&gt;data);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create Linear Filtered Texture</span></span><br><span class="line">        glBindTexture(GL_TEXTURE_2D, texture[<span class="number">1</span>]);</span><br><span class="line">        glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_LINEAR);</span><br><span class="line">        glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR);</span><br><span class="line">        glTexImage2D(GL_TEXTURE_2D, <span class="number">0</span>, <span class="number">3</span>, TextureImage[<span class="number">0</span>]-&gt;sizeX, TextureImage[<span class="number">0</span>]-&gt;sizeY, <span class="number">0</span>, GL_RGB, GL_UNSIGNED_BYTE, TextureImage[<span class="number">0</span>]-&gt;data);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create MipMapped Texture</span></span><br><span class="line">        glBindTexture(GL_TEXTURE_2D, texture[<span class="number">2</span>]);</span><br><span class="line">        glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_LINEAR);</span><br><span class="line">        glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR_MIPMAP_NEAREST);</span><br><span class="line">        </span><br><span class="line">        gluBuild2DMipmaps(GL_TEXTURE_2D, <span class="number">3</span>, TextureImage[<span class="number">0</span>]-&gt;sizeX, TextureImage[<span class="number">0</span>]-&gt;sizeY, GL_RGB, GL_UNSIGNED_BYTE, TextureImage[<span class="number">0</span>]-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (TextureImage[<span class="number">0</span>])                                <span class="comment">// If Texture Exists</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (TextureImage[<span class="number">0</span>]-&gt;data)                      <span class="comment">// If Texture Image Exists</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">free</span>(TextureImage[<span class="number">0</span>]-&gt;data);                <span class="comment">// Free The Texture Image Memory</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">free</span>(TextureImage[<span class="number">0</span>]);                          <span class="comment">// Free The Image Structure</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Status;                                      <span class="comment">// Return The Status</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在读过上一次的代码之后，我们可以很容易的知道这段代码就是将Data/Crate.bmp这张位图转换成纹理并且存放在texture数组中，并且3次渲染的画面都一致（基于这一点，其实我们也可以自己实现不同的3张图片做出3种不同的，不同的是3章图像的glTexParameteri进行滤波的方式并不相同，第一张渲染使用最邻近过滤（GL_NEAREST），第二张使用线性滤波（GL_LINEAR），第三张使用选择最邻近的mip层，使用线性过滤（GL_LINEAR_MIPMAP_NEAREST）。然后就可以在立方体上渲染出不同的团了）。其他的部分改变不大。</p>
<p>上面对纹理映射的滤波器的选择可以参考<a href="https://my.oschina.net/sweetdark/blog/177812" target="_blank" rel="noopener">【OpenGL超级宝典笔记——纹理映射Mipmap】</a>这篇博客，在上面有很详细的解释和说明。</p>
<p>然后在滤波器设置结束之后，最后一行还添加了一个gluBuild2DMipmaps方法，这个在上面的【OpenGL超级宝典笔记——纹理映射Mipmap】中也有提到，是一个能够将任意图像正常缩放到适当大小的方法函数，这样就不用我们费心进行图像的预处理工作了。</p>
<p>好了，到这里LoadGLTextures就设置完毕了。</p>
<p>接着就到InitGL函数了，我们在第六课中已经设置了GLEnable以及glHint进行纹理绑定工作了。我们需要在后面添加新的方法，用来实现光源的初始化。具体参考代码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">InitGL</span><span class="params">(GLvoid)</span>                                      <span class="comment">// All Setup For OpenGL Goes Here</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!LoadGLTextures())                              <span class="comment">// Jump To Texture Loading Routine</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> FALSE;                                   <span class="comment">// If Texture Didn't Load Return FALSE</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    glEnable(GL_TEXTURE_2D);                            <span class="comment">// Enable Texture Mapping</span></span><br><span class="line">    glShadeModel(GL_SMOOTH);                            <span class="comment">// Enable Smooth Shading</span></span><br><span class="line">    glClearColor(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">0.5f</span>);               <span class="comment">// Black Background</span></span><br><span class="line">    glClearDepth(<span class="number">1.0f</span>);                                 <span class="comment">// Depth Buffer Setup</span></span><br><span class="line">    glEnable(GL_DEPTH_TEST);                            <span class="comment">// Enables Depth Testing</span></span><br><span class="line">    glDepthFunc(GL_LEQUAL);                             <span class="comment">// The Type Of Depth Testing To Do</span></span><br><span class="line">    glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);  <span class="comment">// Really Nice Perspective Calculations</span></span><br><span class="line"></span><br><span class="line">    glLightfv(GL_LIGHT1, GL_AMBIENT, LightAmbient);     <span class="comment">// Setup The Ambient Light</span></span><br><span class="line">    glLightfv(GL_LIGHT1, GL_DIFFUSE, LightDiffuse);     <span class="comment">// Setup The Diffuse Light</span></span><br><span class="line">    glLightfv(GL_LIGHT1, GL_POSITION,LightPosition);    <span class="comment">// Position The Light</span></span><br><span class="line">    glEnable(GL_LIGHT1);                                <span class="comment">// Enable Light One</span></span><br><span class="line">    <span class="keyword">return</span> TRUE;                                        <span class="comment">// Initialization Went OK</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>新增了一个1号光源GL_LIGHT1。在对GL_LIGHT新增的3个glLightfv方法中，第一个表示设置环境光（Ambient Light），传入我们已经定义好的全局变量LightAmbient；第二个是漫射光（Diffuse Light），传入我们已经定义好的全局变量LightDiffuse；第三个是光源位置，传入我们定义好的LightPosition。最后使用glEnable启用光源。</p>
<p>到这里点光源的初始化操作就结束了。和设置渲染一样，我们接着要在DrawGLScene中添加光源的某些设置，</p>
<p>在OpenGL中，法线是指经过面(多边形）上的一点且垂直于这个面(多边形)的直线。使用光源的时候必须指定一条法线。法线告诉OpenGL这个多边形的朝向，并指明多边形的正面和背面。如果没有指定法线，什么怪事情都可能发生：不该照亮的面被照亮了，多边形的背面也被照亮….。对了，法线应该指向多边形的外侧。</p>
<p>所以我们在DrawGLScene中绘制图像的时候，也要同时设置法线。一般来说在绘制一个平面之前，我们就要预先定义好这个平面的法线。参考代码如下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">DrawGLScene</span><span class="params">(GLvoid)</span>                                 <span class="comment">// Here's Where We Do All The Drawing</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); <span class="comment">// Clear The Screen And The Depth Buffer</span></span><br><span class="line">    glLoadIdentity();                                   <span class="comment">// Reset The View</span></span><br><span class="line">    glTranslatef(<span class="number">0.0f</span>,<span class="number">0.0f</span>,z);</span><br><span class="line"></span><br><span class="line">    glRotatef(xrot,<span class="number">1.0f</span>,<span class="number">0.0f</span>,<span class="number">0.0f</span>);</span><br><span class="line">    glRotatef(yrot,<span class="number">0.0f</span>,<span class="number">1.0f</span>,<span class="number">0.0f</span>);</span><br><span class="line"></span><br><span class="line">    glBindTexture(GL_TEXTURE_2D, texture[filter]);</span><br><span class="line"></span><br><span class="line">    glBegin(GL_QUADS);</span><br><span class="line">        <span class="comment">// Front Face</span></span><br><span class="line">        glNormal3f( <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">0.0f</span>, <span class="number">0.0f</span>); glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>,  <span class="number">1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">1.0f</span>, <span class="number">0.0f</span>); glVertex3f( <span class="number">1.0f</span>, <span class="number">-1.0f</span>,  <span class="number">1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">1.0f</span>, <span class="number">1.0f</span>); glVertex3f( <span class="number">1.0f</span>,  <span class="number">1.0f</span>,  <span class="number">1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">0.0f</span>, <span class="number">1.0f</span>); glVertex3f(<span class="number">-1.0f</span>,  <span class="number">1.0f</span>,  <span class="number">1.0f</span>);</span><br><span class="line">        <span class="comment">// Back Face</span></span><br><span class="line">        glNormal3f( <span class="number">0.0f</span>, <span class="number">0.0f</span>,<span class="number">-1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">1.0f</span>, <span class="number">0.0f</span>); glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">1.0f</span>, <span class="number">1.0f</span>); glVertex3f(<span class="number">-1.0f</span>,  <span class="number">1.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">0.0f</span>, <span class="number">1.0f</span>); glVertex3f( <span class="number">1.0f</span>,  <span class="number">1.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">0.0f</span>, <span class="number">0.0f</span>); glVertex3f( <span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line">        <span class="comment">// Top Face</span></span><br><span class="line">        glNormal3f( <span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">0.0f</span>, <span class="number">1.0f</span>); glVertex3f(<span class="number">-1.0f</span>,  <span class="number">1.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">0.0f</span>, <span class="number">0.0f</span>); glVertex3f(<span class="number">-1.0f</span>,  <span class="number">1.0f</span>,  <span class="number">1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">1.0f</span>, <span class="number">0.0f</span>); glVertex3f( <span class="number">1.0f</span>,  <span class="number">1.0f</span>,  <span class="number">1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">1.0f</span>, <span class="number">1.0f</span>); glVertex3f( <span class="number">1.0f</span>,  <span class="number">1.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line">        <span class="comment">// Bottom Face</span></span><br><span class="line">        glNormal3f( <span class="number">0.0f</span>,<span class="number">-1.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">1.0f</span>, <span class="number">1.0f</span>); glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">0.0f</span>, <span class="number">1.0f</span>); glVertex3f( <span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">0.0f</span>, <span class="number">0.0f</span>); glVertex3f( <span class="number">1.0f</span>, <span class="number">-1.0f</span>,  <span class="number">1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">1.0f</span>, <span class="number">0.0f</span>); glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>,  <span class="number">1.0f</span>);</span><br><span class="line">        <span class="comment">// Right face</span></span><br><span class="line">        glNormal3f( <span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">1.0f</span>, <span class="number">0.0f</span>); glVertex3f( <span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">1.0f</span>, <span class="number">1.0f</span>); glVertex3f( <span class="number">1.0f</span>,  <span class="number">1.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">0.0f</span>, <span class="number">1.0f</span>); glVertex3f( <span class="number">1.0f</span>,  <span class="number">1.0f</span>,  <span class="number">1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">0.0f</span>, <span class="number">0.0f</span>); glVertex3f( <span class="number">1.0f</span>, <span class="number">-1.0f</span>,  <span class="number">1.0f</span>);</span><br><span class="line">        <span class="comment">// Left Face</span></span><br><span class="line">        glNormal3f(<span class="number">-1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">0.0f</span>, <span class="number">0.0f</span>); glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">1.0f</span>, <span class="number">0.0f</span>); glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>,  <span class="number">1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">1.0f</span>, <span class="number">1.0f</span>); glVertex3f(<span class="number">-1.0f</span>,  <span class="number">1.0f</span>,  <span class="number">1.0f</span>);</span><br><span class="line">        glTexCoord2f(<span class="number">0.0f</span>, <span class="number">1.0f</span>); glVertex3f(<span class="number">-1.0f</span>,  <span class="number">1.0f</span>, <span class="number">-1.0f</span>);</span><br><span class="line">    glEnd();</span><br><span class="line"></span><br><span class="line">    xrot+=xspeed;</span><br><span class="line">    yrot+=yspeed;</span><br><span class="line">    <span class="keyword">return</span> TRUE;                                        <span class="comment">// Keep Going</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>每新定义一个平面，我们都需要调用glNormal3f定义好一个法向量。法向量的3个参数分别表示其在X轴，Y轴，Z轴上的分量的长度。法向量的值是由面上的点计算出来的。</p>
<p>到这一步，我们编译运行以后就已经能够看到在点光源下的一个木箱子的图案，接下来我们将为其添加键盘控制功能。这部分在WinMain内。</p>
<p>我们在课程1上已经知道，nehe教程中，按键的反馈是在WinMain的一个while循环中，不断检测事件，然后对不同事件进行相应的反馈。里面已经添加了F1进行全屏控制的时间控制，我们要做的就是模仿F1的工作机制，添加其他按键的反馈。</p>
<p>在以前的while循环中，按键的触发设置代码如下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(!done)                                    <span class="comment">// Loop That Runs While done=FALSE</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (PeekMessage(&amp;msg,<span class="literal">NULL</span>,<span class="number">0</span>,<span class="number">0</span>,PM_REMOVE))   <span class="comment">// Is There A Message Waiting?</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (msg.message==WM_QUIT)               <span class="comment">// Have We Received A Quit Message?</span></span><br><span class="line">        &#123;</span><br><span class="line">            done=TRUE;                          <span class="comment">// If So done=TRUE</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>                                    <span class="comment">// If Not, Deal With Window Messages</span></span><br><span class="line">        &#123;</span><br><span class="line">            TranslateMessage(&amp;msg);             <span class="comment">// Translate The Message</span></span><br><span class="line">            DispatchMessage(&amp;msg);              <span class="comment">// Dispatch The Message</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>                                        <span class="comment">// If There Are No Messages</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Draw The Scene.  Watch For ESC Key And Quit Messages From DrawGLScene()</span></span><br><span class="line">        <span class="keyword">if</span> ((active &amp;&amp; !DrawGLScene()) || keys[VK_ESCAPE])  <span class="comment">// Active?  Was There A Quit Received?</span></span><br><span class="line">        &#123;</span><br><span class="line">            done=TRUE;                          <span class="comment">// ESC or DrawGLScene Signalled A Quit</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>                                    <span class="comment">// Not Time To Quit, Update Screen</span></span><br><span class="line">        &#123;</span><br><span class="line">            SwapBuffers(hDC);                   <span class="comment">// Swap Buffers (Double Buffering)</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (keys[VK_F1])                        <span class="comment">// Is F1 Being Pressed?</span></span><br><span class="line">        &#123;</span><br><span class="line">            keys[VK_F1]=FALSE;                  <span class="comment">// If So Make Key FALSE</span></span><br><span class="line">            KillGLWindow();                     <span class="comment">// Kill Our Current Window</span></span><br><span class="line">            fullscreen=!fullscreen;             <span class="comment">// Toggle Fullscreen / Windowed Mode</span></span><br><span class="line">            <span class="comment">// Recreate Our OpenGL Window</span></span><br><span class="line">            <span class="keyword">if</span> (!CreateGLWindow(<span class="string">"NeHe's Texture Mapping Tutorial"</span>,<span class="number">640</span>,<span class="number">480</span>,<span class="number">16</span>,fullscreen))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;                       <span class="comment">// Quit If Window Was Not Created</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在确认ESC按键未被按下之前，OpenGL将会不停的绘制图片。在这个窗口刷新工作结束以后，我们开始了F1的按键判断。由此，我们可以在这个基础上，进一步扩展了。扩展的代码如下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (!done)                                   <span class="comment">// Loop That Runs While done=FALSE</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (PeekMessage(&amp;msg, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="number">0</span>, PM_REMOVE))   <span class="comment">// Is There A Message Waiting?</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (msg.message == WM_QUIT)             <span class="comment">// Have We Received A Quit Message?</span></span><br><span class="line">            &#123;</span><br><span class="line">                done = TRUE;                            <span class="comment">// If So done=TRUE</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>                                    <span class="comment">// If Not, Deal With Window Messages</span></span><br><span class="line">            &#123;</span><br><span class="line">                TranslateMessage(&amp;msg);             <span class="comment">// Translate The Message</span></span><br><span class="line">                DispatchMessage(&amp;msg);              <span class="comment">// Dispatch The Message</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>                                        <span class="comment">// If There Are No Messages</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// Draw The Scene.  Watch For ESC Key And Quit Messages From DrawGLScene()</span></span><br><span class="line">            <span class="keyword">if</span> ((active &amp;&amp; !DrawGLScene()) || keys[VK_ESCAPE])  <span class="comment">// Active?  Was There A Quit Received?</span></span><br><span class="line">            &#123;</span><br><span class="line">                done = TRUE;                            <span class="comment">// ESC or DrawGLScene Signalled A Quit</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>                                    <span class="comment">// Not Time To Quit, Update Screen</span></span><br><span class="line">            &#123;</span><br><span class="line">                SwapBuffers(hDC);                   <span class="comment">// Swap Buffers (Double Buffering)</span></span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (keys[<span class="string">'L'</span>] &amp;&amp; !lp)</span><br><span class="line">            &#123;</span><br><span class="line">                lp = TRUE;</span><br><span class="line">                light = !light;</span><br><span class="line">                <span class="keyword">if</span> (!light)</span><br><span class="line">                &#123;</span><br><span class="line">                    glDisable(GL_LIGHTING);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    glEnable(GL_LIGHTING);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!keys[<span class="string">'L'</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                lp = FALSE;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (keys[<span class="string">'F'</span>] &amp;&amp; !fp)</span><br><span class="line">            &#123;</span><br><span class="line">                fp = TRUE;</span><br><span class="line">                filter += <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (filter&gt;<span class="number">2</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    filter = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!keys[<span class="string">'F'</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                fp = FALSE;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (keys[VK_PRIOR])</span><br><span class="line">            &#123;</span><br><span class="line">                z -= <span class="number">0.02f</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (keys[VK_NEXT])</span><br><span class="line">            &#123;</span><br><span class="line">                z += <span class="number">0.02f</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (keys[VK_UP])</span><br><span class="line">            &#123;</span><br><span class="line">                xspeed -= <span class="number">0.01f</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (keys[VK_DOWN])</span><br><span class="line">            &#123;</span><br><span class="line">                xspeed += <span class="number">0.01f</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (keys[VK_RIGHT])</span><br><span class="line">            &#123;</span><br><span class="line">                yspeed += <span class="number">0.01f</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (keys[VK_LEFT])</span><br><span class="line">            &#123;</span><br><span class="line">                yspeed -= <span class="number">0.01f</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (keys[VK_F1])                        <span class="comment">// Is F1 Being Pressed?</span></span><br><span class="line">            &#123;</span><br><span class="line">                keys[VK_F1] = FALSE;                    <span class="comment">// If So Make Key FALSE</span></span><br><span class="line">                KillGLWindow();                     <span class="comment">// Kill Our Current Window</span></span><br><span class="line">                fullscreen = !fullscreen;               <span class="comment">// Toggle Fullscreen / Windowed Mode</span></span><br><span class="line">                                                        <span class="comment">// Recreate Our OpenGL Window</span></span><br><span class="line">                <span class="keyword">if</span> (!CreateGLWindow(<span class="string">"NeHe's Textures, Lighting &amp; Keyboard Tutorial"</span>, <span class="number">640</span>, <span class="number">480</span>, <span class="number">16</span>, fullscreen))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>;                       <span class="comment">// Quit If Window Was Not Created</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>如果按下L建，就对光源GL_LIGHTING进行改变（我们在初始化InitGL的时候，就曾经调用过glEnable，不知道你是否还有印象）。其他部分都不难，这里就不一一解释了。</p>
<p>另外需要说明的是，因为在NEHE教程的前文中，按键反馈是在刷新屏幕<code>if ((active &amp;&amp; !DrawGLScene()) || keys[VK_ESCAPE])</code>这个判断结束之后才进行的按键反馈，而在其之后的代码中，却又将ESC之外的按键触发部分放进了判断条件之内。我这里模仿的是作者以前的按键触发设置，所以代码和作者lesson7的代码稍有不同。不过最终效果其实一致——只不过我的会在按下ESC之后延迟一帧才推出，而作者按下ESC立刻退出，因为刷新频率很快，所以其实想过一只。</p>
<p>最后，实验正确运行的话，你应该能够在窗口中正常的运行你的第一个有按键反馈的窗口游戏了。L打开灯光，F设置不同的滤波器，上下左右方向键分别设置不同的旋转方向，PageUp和PageDown分别将图形靠近或者远离我们。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/07/OpenGL学习笔记（四）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/07/OpenGL学习笔记（四）/" class="post-title-link" itemprop="url">OpenGL学习笔记（四）</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-07 12:20:57" itemprop="dateCreated datePublished" datetime="2017-05-07T12:20:57+08:00">2017-05-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-06-02 18:03:16" itemprop="dateModified" datetime="2019-06-02T18:03:16+08:00">2019-06-02</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>龙云尧个人博客，转载请注明出处。</strong></p>
<p>CSDN地址：<a href="http://blog.csdn.net/michael753951/article/details/71316089" target="_blank" rel="noopener">http://blog.csdn.net/michael753951/article/details/71316089</a></p>
<p>个人blog地址：<a href="http://yaoyl.cn/nehexue-xi-bi-ji-si/" target="_blank" rel="noopener">http://yaoyl.cn/nehexue-xi-bi-ji-si/</a></p>
<hr>
<h2 id="图像旋转"><a href="#图像旋转" class="headerlink" title="图像旋转"></a>图像旋转</h2><p>接下来我们将学习图像旋转。图像的旋转通过调用glRotatef(Angle,Xvector,Yvector,Zvector)实现。Angle表示旋转角度（注意是角度不是弧度），Xvector表示沿X轴旋转，Yvector表示沿着Y轴旋转，Zvector表示沿着Z轴旋转。注意旋转角度和RGB设置不一样，RGB的范围是0.0f-1.0f，而角度旋转的范围是0.0f-360.0f(其实可以超过360.0f，不过为了避免溢出我们应该将其做一个约束)。</p>
<p>图像的旋转方向遵循右手定则，即右手握住旋转的轴，右手大拇指朝向轴的正方向，那么你右手其他手指所朝的方向便为正方向。</p>
<p>为了实现图像的旋转，我们将尝试调用一个glRotatef方法。</p>
<p>首先我们还是在DrawGLScene方法中，通过glTranslatef确定绘点以后，我们就可以插入glRotatef(rtri, 0.0f, 0.0f, 1.0f)来绕着Z轴旋转。为此我们需要定义一个GLfloat类型的全局变量rtri。同时在DrawGLScene方法结束之前我们需要不断改变rtri的值来实现图像的旋转工作。</p>
<p>最终的参考代码如下（注意需要自己定义一个全局变量rtri）。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">DrawGLScene</span><span class="params">(GLvoid)</span>                                 <span class="comment">// 从这里开始进行所有的绘制</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); <span class="comment">// 清除屏幕和深度缓存</span></span><br><span class="line">    glLoadIdentity();                                   <span class="comment">// 重置当前的模型观察矩阵</span></span><br><span class="line">    <span class="comment">//当您调用glLoadIdentity()之后，您实际上将当前点移到了屏幕中心，X坐标轴从左至右，Y坐标轴从下至上，Z坐标轴从里至外。</span></span><br><span class="line">    <span class="comment">//中心左面的坐标值是负值，右面是正值。移向屏幕顶端是正值，移向屏幕底端是负值。移入屏幕深处是负值，移出屏幕则是正值。 </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//glTranslatef(x, y, z)沿着 X, Y 和 Z 轴移动。</span></span><br><span class="line">    <span class="comment">//根据前面的次序，下面的代码沿着X轴左移1.5个单位，Y轴不动(0.0f)，最后移入屏幕6.0f个单位。</span></span><br><span class="line">    <span class="comment">//注意在glTranslatef(x, y, z)中当您移动的时候，您并不是相对屏幕中心移动，而是相对与当前所在的屏幕位置。</span></span><br><span class="line">    glTranslatef(<span class="number">-1.5f</span>, <span class="number">0.0f</span>, <span class="number">-6.0f</span>);                   <span class="comment">// 左移 1.5 单位，并移入屏幕 6.0</span></span><br><span class="line">    glRotatef(rtri, <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);                      <span class="comment">// Rotate The Triangle On The Y axis ( NEW )</span></span><br><span class="line">    <span class="comment">//glBegin(GL_TRIANGLES)的意思是开始绘制三角形，glEnd() 告诉OpenGL三角形已经创建好了。</span></span><br><span class="line">    <span class="comment">//本节的简单示例中，我们只画一个三角形。如果要画第二个三角形的话，可以在这三点之后，再加三行代码(3点)。</span></span><br><span class="line">    glBegin(GL_TRIANGLES);                              <span class="comment">// Drawing Using Triangles</span></span><br><span class="line">    <span class="comment">//接下来的一行代码设置三角形的第一个顶点(三角形的上顶点)，并使用当前颜色(红色)来绘制。</span></span><br><span class="line">    glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// 设置当前色为红色</span></span><br><span class="line">    glVertex3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                       <span class="comment">// Top</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// 设置当前色为绿色</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>);                     <span class="comment">// Bottom Left</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);                        <span class="comment">// 设置当前色为蓝色</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>);                      <span class="comment">// Bottom Right</span></span><br><span class="line">    glEnd();                                            <span class="comment">// Finished Drawing The Triangle</span></span><br><span class="line">    <span class="comment">//在屏幕的左半部分画完三角形后，我们要移到右半部分来画正方形。为此要再次使用glTranslate。</span></span><br><span class="line">    glTranslatef(<span class="number">3.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);                     <span class="comment">// Move Right 3 Units</span></span><br><span class="line">    <span class="comment">//现在使用GL_QUADS绘制正方形。</span></span><br><span class="line">    glBegin(GL_QUADS);                                  <span class="comment">// Draw A Quad</span></span><br><span class="line">    <span class="comment">//glColor3f(1.0f, 0.0f, 0.0f);                      // 将当前色设置为蓝色</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                      <span class="comment">// Top Left</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                       <span class="comment">// Top Right</span></span><br><span class="line">    <span class="comment">//glColor3f(0.0f, 0.1f, 0.0f);                      // 将当前色设置为蓝色</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>);                      <span class="comment">// Bottom Right</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>);                     <span class="comment">// Bottom Left</span></span><br><span class="line">    glEnd();                                            <span class="comment">// Done Drawing The Quad</span></span><br><span class="line">    rtri += <span class="number">0.2f</span>;                                           <span class="comment">// Increase The Rotation Variable For The Triangle ( NEW )</span></span><br><span class="line">    <span class="keyword">return</span> TRUE;                                        <span class="comment">// Everything Went OK</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现的效果如下图所示。</p>
<p><img src="http://img.blog.csdn.net/20170516074122918?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="section3.1"></p>
<p>上述方法实现了整个画面绕着Z轴旋转的情况，我们接下来将实现两个图像分别旋转的场景。</p>
<p>首先我们尝试直接在绘制矩形之前，直接开始对矩形矩形旋选，旋转结果如下所示。</p>
<p><img src="http://img.blog.csdn.net/20170516074144544?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="section3.2"></p>
<p>这个时候我们发现矩形的旋转很异常，他并不是按照我们理想的情况下绕着自己的X轴旋转。这是因为在之前的三角形旋转过程中，实际在旋转的是整个坐标系（这样做是很有道理里的，它能让我们很方便的画出这个三角形，而不用费心计算每个点在固定参考坐标系下旋转之后新的坐标位置）。</p>
<p>为了解决这个问题，我们在三角形旋转完毕之后，应该重新调用glLoadIdentity进行坐标初始化。然后我们重新设置绘点glTranslatef，注意这个时候绘点的参数应该为(1.5f, 0.0f, -6.0f)，因为重置后绘点坐标为(0.0, 0.0, 0.0)，我们应该将矩形的绘点设置到和三角形相同的位置上。</p>
<p>最终的两个图形的旋转的参考代码如下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">DrawGLScene</span><span class="params">(GLvoid)</span>                                 <span class="comment">// 从这里开始进行所有的绘制</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); <span class="comment">// 清除屏幕和深度缓存</span></span><br><span class="line">    glLoadIdentity();                                   <span class="comment">// 重置当前的模型观察矩阵</span></span><br><span class="line">    <span class="comment">//当您调用glLoadIdentity()之后，您实际上将当前点移到了屏幕中心，X坐标轴从左至右，Y坐标轴从下至上，Z坐标轴从里至外。</span></span><br><span class="line">    <span class="comment">//中心左面的坐标值是负值，右面是正值。移向屏幕顶端是正值，移向屏幕底端是负值。移入屏幕深处是负值，移出屏幕则是正值。 </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//glTranslatef(x, y, z)沿着 X, Y 和 Z 轴移动。</span></span><br><span class="line">    <span class="comment">//根据前面的次序，下面的代码沿着X轴左移1.5个单位，Y轴不动(0.0f)，最后移入屏幕6.0f个单位。</span></span><br><span class="line">    <span class="comment">//注意在glTranslatef(x, y, z)中当您移动的时候，您并不是相对屏幕中心移动，而是相对与当前所在的屏幕位置。</span></span><br><span class="line">    glTranslatef(<span class="number">-1.5f</span>, <span class="number">0.0f</span>, <span class="number">-6.0f</span>);                   <span class="comment">// 左移 1.5 单位，并移入屏幕 6.0</span></span><br><span class="line">    glRotatef(rtri, <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);                  <span class="comment">// Rotate The Triangle On The Y axis ( NEW )</span></span><br><span class="line">    <span class="comment">//glBegin(GL_TRIANGLES)的意思是开始绘制三角形，glEnd() 告诉OpenGL三角形已经创建好了。</span></span><br><span class="line">    <span class="comment">//本节的简单示例中，我们只画一个三角形。如果要画第二个三角形的话，可以在这三点之后，再加三行代码(3点)。</span></span><br><span class="line">    glBegin(GL_TRIANGLES);                              <span class="comment">// Drawing Using Triangles</span></span><br><span class="line">    <span class="comment">//接下来的一行代码设置三角形的第一个顶点(三角形的上顶点)，并使用当前颜色(红色)来绘制。</span></span><br><span class="line">    glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// 设置当前色为红色</span></span><br><span class="line">    glVertex3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                       <span class="comment">// Top</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// 设置当前色为绿色</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>);                     <span class="comment">// Bottom Left</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);                        <span class="comment">// 设置当前色为蓝色</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>);                      <span class="comment">// Bottom Right</span></span><br><span class="line">    glEnd();                                            <span class="comment">// Finished Drawing The Triangle</span></span><br><span class="line">    <span class="comment">//在屏幕的左半部分画完三角形后，我们要移到右半部分来画正方形。为此要再次使用glTranslate。</span></span><br><span class="line">    glLoadIdentity();                                   <span class="comment">// 重置模型观察矩阵</span></span><br><span class="line">    glTranslatef(<span class="number">1.5f</span>, <span class="number">0.0f</span>, <span class="number">-6.0f</span>);                        <span class="comment">// Move Right 3 Units</span></span><br><span class="line">    glRotatef(rquad, <span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);                 <span class="comment">//  绕X轴旋转四边形</span></span><br><span class="line">    <span class="comment">//现在使用GL_QUADS绘制正方形。</span></span><br><span class="line">    glBegin(GL_QUADS);                                  <span class="comment">// Draw A Quad</span></span><br><span class="line">    <span class="comment">//glColor3f(1.0f, 0.0f, 0.0f);                      // 将当前色设置为蓝色</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                      <span class="comment">// Top Left</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                       <span class="comment">// Top Right</span></span><br><span class="line">    <span class="comment">//glColor3f(0.0f, 0.1f, 0.0f);                      // 将当前色设置为蓝色</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>);                      <span class="comment">// Bottom Right</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>);                     <span class="comment">// Bottom Left</span></span><br><span class="line">    glEnd();                                            <span class="comment">// Done Drawing The Quad</span></span><br><span class="line">    <span class="keyword">if</span> (rtri &gt;= <span class="number">360.0f</span>) rtri -= <span class="number">360.0</span>;                  <span class="comment">// control the range of the rtri</span></span><br><span class="line">    <span class="keyword">if</span> (rtri &lt;= <span class="number">0.0f</span>) rtri += <span class="number">360.0</span>;</span><br><span class="line">    rtri += <span class="number">0.2f</span>;                                       <span class="comment">// Increase The Rotation Variable For The Triangle ( NEW )</span></span><br><span class="line">    rquad -= <span class="number">0.15f</span>;      <span class="comment">// 减少四边形的旋转变量</span></span><br><span class="line">    <span class="keyword">return</span> TRUE;                                        <span class="comment">// Everything Went OK</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3D图像的旋转"><a href="#3D图像的旋转" class="headerlink" title="3D图像的旋转"></a>3D图像的旋转</h2><p>我们已经实现了对2D图像的构建着色以及选装，接下来我们将实现一个3D图像的构建以及旋转。</p>
<p>我们在之前构建三角形的教程中已经知道，在glBegin和glEnd之间可以有很多次相同形状的绘制，所以我们将利用这个特点在实验中利用4个三角形绘制一个金字塔，用6个矩形绘制一个立方体。</p>
<p>绘制过程我们就不再赘述了，旋转方式我们在上一次实验中也已经了解了，所以我们直接上代码和结果图。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">DrawGLScene</span><span class="params">(GLvoid)</span>                                 <span class="comment">// 从这里开始进行所有的绘制</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); <span class="comment">// 清除屏幕和深度缓存</span></span><br><span class="line">    glLoadIdentity();                                   <span class="comment">// 重置当前的模型观察矩阵</span></span><br><span class="line">    <span class="comment">//当您调用glLoadIdentity()之后，您实际上将当前点移到了屏幕中心，X坐标轴从左至右，Y坐标轴从下至上，Z坐标轴从里至外。</span></span><br><span class="line">    <span class="comment">//中心左面的坐标值是负值，右面是正值。移向屏幕顶端是正值，移向屏幕底端是负值。移入屏幕深处是负值，移出屏幕则是正值。 </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//glTranslatef(x, y, z)沿着 X, Y 和 Z 轴移动。</span></span><br><span class="line">    <span class="comment">//根据前面的次序，下面的代码沿着X轴左移1.5个单位，Y轴不动(0.0f)，最后移入屏幕6.0f个单位。</span></span><br><span class="line">    <span class="comment">//注意在glTranslatef(x, y, z)中当您移动的时候，您并不是相对屏幕中心移动，而是相对与当前所在的屏幕位置。</span></span><br><span class="line">    glTranslatef(<span class="number">-1.5f</span>, <span class="number">0.0f</span>, <span class="number">-6.0f</span>);                   <span class="comment">// 左移 1.5 单位，并移入屏幕 6.0</span></span><br><span class="line">    glRotatef(rtri, <span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);                  <span class="comment">// Rotate The Triangle On The Y axis ( NEW )</span></span><br><span class="line">    <span class="comment">//glBegin(GL_TRIANGLES)的意思是开始绘制三角形，glEnd() 告诉OpenGL三角形已经创建好了。</span></span><br><span class="line">    <span class="comment">//本节的简单示例中，我们只画一个三角形。如果要画第二个三角形的话，可以在这三点之后，再加三行代码(3点)。</span></span><br><span class="line">    glBegin(GL_TRIANGLES);                              <span class="comment">// Drawing Using Triangles</span></span><br><span class="line">    <span class="comment">//接下来的一行代码设置三角形的第一个顶点(三角形的上顶点)，并使用当前颜色(红色)来绘制。</span></span><br><span class="line">    glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// Red</span></span><br><span class="line">    glVertex3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                   <span class="comment">// Top Of Triangle (Front)</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// Green</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>);                 <span class="comment">// Left Of Triangle (Front)</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);                        <span class="comment">// Blue</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>);                  <span class="comment">// Right Of Triangle (Front)</span></span><br><span class="line">    glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// Red</span></span><br><span class="line">    glVertex3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                   <span class="comment">// Top Of Triangle (Right)</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);                        <span class="comment">// Blue</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>);                  <span class="comment">// Left Of Triangle (Right)</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// Green</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);                 <span class="comment">// Right Of Triangle (Right)</span></span><br><span class="line">    glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// Red</span></span><br><span class="line">    glVertex3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                   <span class="comment">// Top Of Triangle (Back)</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// Green</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);                 <span class="comment">// Left Of Triangle (Back)</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);                        <span class="comment">// Blue</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);                    <span class="comment">// Right Of Triangle (Back)</span></span><br><span class="line">    glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// Red</span></span><br><span class="line">    glVertex3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                   <span class="comment">// Top Of Triangle (Left)</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);                        <span class="comment">// Blue</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);                    <span class="comment">// Left Of Triangle (Left)</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// Green</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>);                 <span class="comment">// Right Of Triangle (Left)</span></span><br><span class="line">    glEnd();                                            <span class="comment">// Finished Drawing The Triangle</span></span><br><span class="line">    <span class="comment">//在屏幕的左半部分画完三角形后，我们要移到右半部分来画正方形。为此要再次使用glTranslate。</span></span><br><span class="line">    glLoadIdentity();                                   <span class="comment">// 重置模型观察矩阵</span></span><br><span class="line">    glTranslatef(<span class="number">1.5f</span>, <span class="number">0.0f</span>, <span class="number">-6.0f</span>);                        <span class="comment">// Move Right 3 Units</span></span><br><span class="line">    glRotatef(rquad, <span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);                 <span class="comment">//  绕X轴旋转四边形</span></span><br><span class="line">    <span class="comment">//现在使用GL_QUADS绘制正方形。</span></span><br><span class="line">    glBegin(GL_QUADS);                                  <span class="comment">// Draw A Quad</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// Set The Color To Green</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">-1.0f</span>);                  <span class="comment">// Top Right Of The Quad (Top)</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">1.0f</span>, <span class="number">-1.0f</span>);                 <span class="comment">// Top Left Of The Quad (Top)</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">1.0f</span>, <span class="number">1.0f</span>);                  <span class="comment">// Bottom Left Of The Quad (Top)</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">1.0f</span>);                   <span class="comment">// Bottom Right Of The Quad (Top)</span></span><br><span class="line">    glColor3f(<span class="number">1.0f</span>, <span class="number">0.5f</span>, <span class="number">0.0f</span>);                        <span class="comment">// Set The Color To Orange</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>);                  <span class="comment">// Top Right Of The Quad (Bottom)</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>);                 <span class="comment">// Top Left Of The Quad (Bottom)</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);                    <span class="comment">// Bottom Left Of The Quad (Bottom)</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);                 <span class="comment">// Bottom Right Of The Quad (Bottom)</span></span><br><span class="line">    glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// Set The Color To Red</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">1.0f</span>);                   <span class="comment">// Top Right Of The Quad (Front)</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">1.0f</span>, <span class="number">1.0f</span>);                  <span class="comment">// Top Left Of The Quad (Front)</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>);                 <span class="comment">// Bottom Left Of The Quad (Front)</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>);                  <span class="comment">// Bottom Right Of The Quad (Front)</span></span><br><span class="line">    glColor3f(<span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);                        <span class="comment">// Set The Color To Yellow</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);                 <span class="comment">// Top Right Of The Quad (Back)</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);                    <span class="comment">// Top Left Of The Quad (Back)</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">1.0f</span>, <span class="number">-1.0f</span>);                 <span class="comment">// Bottom Left Of The Quad (Back)</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">-1.0f</span>);                  <span class="comment">// Bottom Right Of The Quad (Back)</span></span><br><span class="line">    glColor3f(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);                        <span class="comment">// Set The Color To Blue</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">1.0f</span>, <span class="number">1.0f</span>);                  <span class="comment">// Top Right Of The Quad (Left)</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">1.0f</span>, <span class="number">-1.0f</span>);                 <span class="comment">// Top Left Of The Quad (Left)</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);                    <span class="comment">// Bottom Left Of The Quad (Left)</span></span><br><span class="line">    glVertex3f(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>);                 <span class="comment">// Bottom Right Of The Quad (Left)</span></span><br><span class="line">    glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);                        <span class="comment">// Set The Color To Violet</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">-1.0f</span>);                  <span class="comment">// Top Right Of The Quad (Right)</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">1.0f</span>);                   <span class="comment">// Top Left Of The Quad (Right)</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>);                  <span class="comment">// Bottom Left Of The Quad (Right)</span></span><br><span class="line">    glVertex3f(<span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>);                 <span class="comment">// Bottom Right Of The Quad (Right)</span></span><br><span class="line">    glEnd();                                            <span class="comment">// Done Drawing The Quad</span></span><br><span class="line">    <span class="keyword">if</span> (rtri &gt;= <span class="number">360.0f</span>) rtri -= <span class="number">360.0</span>;                  <span class="comment">// control the range of the rtri</span></span><br><span class="line">    <span class="keyword">if</span> (rtri &lt;= <span class="number">0.0f</span>) rtri += <span class="number">360.0</span>;</span><br><span class="line">    rtri += <span class="number">0.2f</span>;                                       <span class="comment">// Increase The Rotation Variable For The Triangle ( NEW )</span></span><br><span class="line">    rquad -= <span class="number">0.15f</span>;      <span class="comment">// 减少四边形的旋转变量</span></span><br><span class="line">    <span class="keyword">return</span> TRUE;                                        <span class="comment">// Everything Went OK</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="http://img.blog.csdn.net/20170507122003199?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="4.1"></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/14/囚笼/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/04/14/囚笼/" class="post-title-link" itemprop="url">囚笼</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-14 17:06:00" itemprop="dateCreated datePublished" datetime="2017-04-14T17:06:00+08:00">2017-04-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-06-02 17:32:38" itemprop="dateModified" datetime="2019-06-02T17:32:38+08:00">2019-06-02</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>一个病人除了说他自己病了以外，还能说什么呢？——<em>塞·约翰逊</em></p>
</blockquote>
<h2 id="现在正在看这篇推送的你对艾滋病了解多少？"><a href="#现在正在看这篇推送的你对艾滋病了解多少？" class="headerlink" title="现在正在看这篇推送的你对艾滋病了解多少？"></a>现在正在看这篇推送的你对艾滋病了解多少？</h2><ul>
<li>你可能知道艾滋病是由HIV病毒引起的；</li>
<li>你可能知道HIV病毒传播途径主要包括血液传播、性传播和母婴传播，此外还有可能通过尿液、泪液等其他体液传播（但是飞沫、握手等日常行为并不会传播）；</li>
<li>你可能知道HIV在人体内的潜伏期平均为8～9年，一旦爆发就是临床上表现的艾滋病；</li>
<li>你可能知道艾滋病爆发会破坏病人的免疫系统，造成病人的免疫系统紊乱，使病人极易受到各种感染或者罹患癌症；</li>
<li>你还可能知道一个良好的心态和健康的锻炼对艾滋病的治疗会有所帮助。</li>
</ul>
<p>可是你知道的内容大概也就仅限于此了。</p>
<h2 id="初访艾滋"><a href="#初访艾滋" class="headerlink" title="初访艾滋"></a>初访艾滋</h2><p>出发的高铁上，我刷着VICE的 [ <a href="http://mp.weixin.qq.com/s/OtB0-GGbB2wqk_F_AGxOyA" target="_blank" rel="noopener">我们问了几个艾滋携带者，愿意这辈子只吃饺子皮还是感染 HIV？</a> ]，想着待会该怎么说话，想着可以拿到几个公益时，想着还能不能赶回来拿快递，想着今天的晚餐。</p>
<p>一切似乎就像在广州地下来来往往的地铁一样，按部就班。</p>
<h2 id="笼"><a href="#笼" class="headerlink" title="笼"></a>笼</h2><p>沉寂。</p>
<p>所有人都带着口罩。</p>
<p>病人躺在病床上，没有呻吟。电子屏规律的跳动，没有一点干扰。家属在病人旁边或削水果，或枕着床沿休息，或在走廊外的小板凳上想些什么。护工在走廊上自顾地擦着玻璃。</p>
<p>一切似乎都很安静，安静中夹杂着一丝灰色。</p>
<p>第一个病房，拥挤，稍显杂乱。三个病人躺在里面。</p>
<p>突然进入的我们5个人，几乎占据了病房剩余空间的一半。</p>
<p>介绍完此行的目的猴，我开始试着和靠在门口的病人进行交流。</p>
<p>这是我第一次访问重症病人，我没察觉他旁边起伏的呼吸机显示着他已经很虚弱，甚至当我们刚开始对话时我都没察觉他说话已经颇为费力。</p>
<p>他很瘦，露在被单的小腿已经不像我们那般结实，嶙峋的胸膛贴着呼吸机的某种贴片，眼看体重不会超过100斤。</p>
<p>他用一支空闲的手轻轻的笔画，配合着几乎已经模糊的吐字介绍着他现在正在进行的治疗。</p>
<p>我突然反应过来他现在并不适合说话。和另一名同行队员将手中的水果放在床头柜，送上祈愿，退出走廊和他的弟弟开始了对话。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">“他原来有170斤。”</span><br><span class="line"></span><br><span class="line">病人的家属指了指床上的哥哥。“病发后一直瘦，就</span><br><span class="line">变成了现在这个样子。”</span><br><span class="line"></span><br><span class="line">“我们也只有平时多安抚他啊，要对活下去有希望</span><br><span class="line">啊。但是他本身（求生）欲望其实不高。”家属看</span><br><span class="line">了看走廊中部某个病房，“两天前刚从那间病房拉</span><br><span class="line">走一个人。”</span><br></pre></td></tr></table></figure>

<p>平淡的语气，似乎已经司空见惯。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">“不管情况怎么糟，总要对生存下去抱有希望啊，”</span><br><span class="line">我开始根据我仅知道的一点艾滋病知识安慰他，</span><br><span class="line">“艾滋病只要能够好好控制，按时吃药，拥有一个良</span><br><span class="line">好的心态，其实生活和正常人差不多。你平时给他多</span><br><span class="line">打气，多带他出去走走，对他的治疗会有好处的。”</span><br><span class="line"></span><br><span class="line">“他现在已经基本走不动了。其实很久以前他就查出</span><br><span class="line">来了身上有异常。去医院好不容易压（制）下来，医</span><br><span class="line">生告诫他，不能停药，病才能控制得住。但是回去没</span><br><span class="line">几天他还是自己停了，”家属看着病床上的哥哥，小</span><br><span class="line">声说，“但是其实药是可以免费领的。前两年还挺正</span><br><span class="line">常的。但是后面他慢慢的发现老是咳嗽，偏偏他自己</span><br><span class="line">又喜欢拖着，等到严重了才去大医院检查。结果透析</span><br><span class="line">的时候发现，病灶转移了。肺里面有一团絮状阴影，</span><br><span class="line">真菌感染的。”</span><br></pre></td></tr></table></figure>

<p>我突然语塞，不知道该怎么继续安抚家人，因为我发现我既无法站在一个旁观者的角度说“要保持一个良好的心态接受治疗”，也无法冷静的说“如果他当时及时吃药，是不会有这样的境况的”。</p>
<p>一个只能靠呼吸机维生的人，浑身痛楚的人，怎么谈心态良好。</p>
<p>一个消瘦至此、离不开床的人，怎么能后悔“如果当初”。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">但是还是得给家属鼓气，至少树立点信心还是好的，</span><br><span class="line">我想。</span><br><span class="line"></span><br><span class="line">“家人还是多劝导他，艾滋虽然可怕，但是好好疗养，</span><br><span class="line">能够过上正常的生活就好了。”</span><br><span class="line"></span><br><span class="line">“其实糖尿病也是很惨的”。我开始比惨，“糖尿病也</span><br><span class="line">是终生没法治疗，只能保守治疗。糖尿病平常也是要</span><br><span class="line">控制饮食加上不停吃药。如果碰上其他并发症，血管</span><br><span class="line">病变之类了，也是很痛苦的。”</span><br><span class="line"></span><br><span class="line">“不不不，艾滋可怕多了。艾滋（HIV病毒）潜伏周期</span><br><span class="line">长，10年都可以和没事人一样。这段时间你要是发现</span><br><span class="line">了，提早预防，提早控制，说不定还能一辈子不爆发</span><br><span class="line">（艾滋病）。但是你如果没发现，还一点不照顾自己</span><br><span class="line">身体，有一点毛病就开药打针，你的免疫力下降了，</span><br><span class="line">提前爆发都有可能。一旦发病，就要格外小心，你的</span><br><span class="line">免疫力那么差，万一不小心交叉感染就很容易出事</span><br><span class="line">了……”</span><br></pre></td></tr></table></figure>

<p>终于，病房中一直捂着头的大爷打断了我们对这个病房的探视，他有点不耐烦的比划着让我们离开。</p>
<p>大概是我们打扰了他的休息，或者是空气被我们搅动的有些浑浊让他不舒服，亦或是担心我们带来什么传染源。</p>
<p>我们当然不敢多问，离开后开始继续往后探访。</p>
<p>……</p>
<p>整个楼层差不多10间病房，大部分是中年或者老年人。</p>
<p>只碰到一个和我们年纪相仿的年轻人。不过他听完我们的介绍，便静静地拿着手机翻了个身，背朝着我们，面朝自己母亲。</p>
<p>我们自然很识趣的不去“打扰”他。</p>
<p>我们在这层楼呆了差不多3个小时。基本没见过病人走出病房走动，那些看上去还挺健康，能起身走动的人被悬在床上的吊瓶束缚着不能到处走动。</p>
<p>唯独有一个老大爷。</p>
<p>大爷其实还挺精神的，虽然头发已经开始稀疏，但是胜在黑多白少，清澈的眼眸总透着一股睿智。他扶着板凳走出病房，吹着徐凤，闭目养神。有一个队友看见他出来以后便走向他，我也慢步跟了上去。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">“我80了。”</span><br></pre></td></tr></table></figure>

<p>老爷子在凳子上给我们讲述他年轻时候的故事。</p>
<p>从大学毕业开始，到被分配至广州，再到在广州扎根，以及现在两个儿子还有孙子已经彻底融入广州的故事。</p>
<p>很平淡，但是老人说的津津有味。</p>
<p>……</p>
<p>6点，我们这一支队伍探访完毕，等着另一只队伍结束一起返校。</p>
<p>一个大叔提着一个板凳，走到楼梯拐角，试探性的问我们——“你们是中山大学的？”。</p>
<p>这个我们在进入病房前就已经说过了。</p>
<p>很明显，他是在有话想跟我们说，只是故意用那这句话作为开场白。</p>
<p>我们队伍两名女生走了过去。</p>
<p>不多时，那边传来了啜泣声——是那位中年大叔的。</p>
<p>我在楼梯口让队伍另一名女生递了一份餐巾纸过去——我知道我对安抚人这种事情并不擅长。</p>
<p>然而，大叔的哭声在那之后愈发嚎啕。</p>
<p><strong>他哭的像个孩子。</strong></p>
<p>差不多7点，女生们才安抚完大叔。我们开始准备启程返校。</p>
<p>路上我从另一名女生口中知道了事情的缘由。</p>
<p>大叔只有两周时间筹集手术费用，原本是通过轻松筹筹款的。但是大叔家住农村，担心因为自己的事情影响了家人在其他人眼中的形象，他停掉了轻松筹上的筹款。</p>
<p>他想通过抵押房产贷款手续费，但是房产证还没过户，银行办不了。想走法律程序拿到房产证，但是时间已经由不得他。</p>
<p>另外家人现在对他的态度也不是很好，不是很支持他。</p>
<p>他很无助，想从我们队伍中寻求帮助。</p>
<h2 id="囚"><a href="#囚" class="headerlink" title="囚"></a>囚</h2><p>晚上在寝室，我和一个学医的朋友谈到这次行程。</p>
<p><strong>谈着谈着，我开始感觉艾滋病患者们生活在一个囚笼中。</strong></p>
<center>**舆论**</center>

<p>不光之前那个向我们哭诉的大叔。现在几乎没有人敢坦诚自己是艾滋病患者（HIV携带者）。</p>
<p>有的人担心舆论会影响自己的正常利益受损——工作受阻，或者在公众场合受到歧视等<br>也有人担心舆论会影响自己的名声——社会上普遍认为艾滋病患者不是当年风流落下的，就认为他吸毒</p>
<p><strong>舆论之下，他们宁愿躲在囚牢的阴影里。</strong></p>
<center>**治疗**</center>

<p>探访中，我和一名能够自由起身吃饭的患者闲聊，“多走动走动呗，有利于身体健康，也有利于治疗”。</p>
<p>这句话我在无数宣传册上看到过，想必应该不会有问题。</p>
<p>病人无奈的笑笑，“我基本一天吊水就有十几个小时，哪有什么机会出去走动。”</p>
<p>“而且外面空气太乱了，不小心就有可能交叉感染。”她的妻子扒了一口饭，补充到。</p>
<p>能将这一切看开的大抵也就只有那位80岁的老大爷了。</p>
<p><strong>大多数患者经历着长时间的治疗，再者担心自己一不小心被感染，只能在牢笼中过着提心吊胆的日子。</strong></p>
<center>**未知**</center>

<p>集中式的病房一定程度上减少了交叉感染的概率，也让医院的管理更加高效。</p>
<p>但是这也造就了这里压抑的氛围。</p>
<p>在这里的病人，睡觉之前不知道自己能不能看见第二天的太阳，也不知道下一个被“狱卒”带走的是谁，甚至都不知道自己肉体和精神还能在这种环境中撑到什么时候。</p>
<p><strong>囚笼外面，狱卒始终在徘徊。</strong></p>
<center>**社会**</center>

<p>目前社会上依然处于谈艾色变的环境。</p>
<p>广大普通人对艾滋的了解还是有不足。人们对待艾滋病患者（甚至HIV携带者）依旧处于一种排斥的态度。</p>
<p>这也就造成了艾滋病患者（以及HIV携带者）对自我在社会定位中的不足。他们自己将自己的画作“其他人”，害怕遭受周围人的歧视。患者从心理上被画牢“囚禁”起来。</p>
<p>艾滋面临的不仅仅是身体上的问题，其实更包含心理上的问题。</p>
<p><strong>无形的囚笼笼罩了他们，笼内的人渴望自由。</strong></p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>这次探访其实挺沉重的。</p>
<p>我抱着蹭公益时的心出发，回程却再无心顾念公益时。脑子里反复旋转的是今天见到的一张张面孔。</p>
<p>我曾因伤住院，那一个星期憋在病房就已经差点逼疯我，不敢想艾滋病病人们要在病房中熬过被囚禁的日日夜夜。</p>
<p>我们的艾滋病的知识普及度正在不断扩展，关于艾滋病的讲座也在不断开展。但是想要打破这个囚笼依然有很长一段路要走。</p>
<p>我们在和病人的实际接触中，发现尽管我们对患者抱有希望，但是患者对自身却常处于一种放弃的态度。<strong>尽我们所能为他们重拾希望</strong>，想必就是我们此行最大的意义了吧。</p>
<p>最后，希望有一天HIV等病毒能够想天牛病毒一样，在这个世界上消失吧。</p>
<h2 id="再说点什么"><a href="#再说点什么" class="headerlink" title="再说点什么"></a>再说点什么</h2><p>对于艾滋，依旧有很多人是恐惧的。但是它的传播途径始终有限，正常人和艾滋病患者接触过程中的正常接触是不会出问题的。在探访过程中，我也是<strong>披长衣长裤戴口罩</strong>的，避免有自己不注意的伤口暴露在空气中。</p>
<p>另外，也挺庆幸自己进大学之后每年有献血这个习惯的。毕竟像我这么懒的人，每年能够进行一次严格的，免费的血检能给我免去很多麻烦。</p>
<p>最后的最后，希望认识的或者不认识的，健康的或者正在和病魔斗争的你们，好好照顾自己的身体。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">24</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.1.2</div>
<div class="BbeiAn-info">
姚云龙 版权所有 粤ICP备 -
<a target="_blank" href="http://www.miitbeian.gov.cn/">17050867-1号</a>

</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.2"></script>

  <script src="/js/motion.js?v=7.1.2"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.2"></script>



  

  


  <script src="/js/next-boot.js?v=7.1.2"></script>


  

  

  

  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
